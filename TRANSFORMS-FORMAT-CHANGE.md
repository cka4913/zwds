# 四化显示格式更新

## 修改对比

### 旧格式
```
四化：
生年四化：
．生年四化乙干天機化祿
．生年四化乙干天梁化權
宫位四化：
．命宮庚干飛入夫妻宮太陽化祿
．命宮庚干飛入子女宮武曲化權
飞入四化：
．兄弟宮己干飛入命宮天梁化科
．夫妻宮戊干飛入命宮天機化忌
```

### 新格式（当前）
```
生年四化：
．生年乙干天機化祿
．生年乙干天梁化權
宫位四化：
．命宮庚干太陽化祿入夫妻宮
．命宮庚干武曲化權入子女宮
飞入四化：
．兄弟宮己干天梁化科入命宮
．夫妻宮戊干天機化忌入命宮
```

## 改动说明

### 1. 移除"四化："标题
- **旧**：开头显示"四化："
- **新**：直接显示三个部分标题，不显示总标题

### 2. 简化生年四化
- **旧**：`生年四化乙干天機化祿`
- **新**：`生年乙干天機化祿`
- **改动**：移除"四化"两字

### 3. 调整宫位四化格式
- **旧**：`命宮庚干飛入夫妻宮太陽化祿`
- **新**：`命宮庚干太陽化祿入夫妻宮`
- **改动**：
  - 移除"飛入"
  - 星曜和化象移到中间
  - 改用"入"字
  - 格式：`发射宫 + 天干 + 星曜 + 化象 + 入 + 目的宫`

### 4. 调整飞入四化格式
- **旧**：`兄弟宮己干飛入命宮天梁化科`
- **新**：`兄弟宮己干天梁化科入命宮`
- **改动**：同宫位四化

### 5. 自化标注保持不变
- **格式**：`財帛宮戊干太陰化權入財帛宮（自權）`
- 继续在末尾标注"（自X）"

## 完整示例

### 案例1：1975-10-23 男命 命宫

```
【命宮：宮位在庚辰】
大限年份：1978-1987
流年年份：1904,1916,1928,1940,1952,1964,1976,1988,2000,2012,2024,2036
主星有：天機利．天梁廟
輔星有：文昌旺．擎羊廟
生年四化：
．生年乙干天機化祿
．生年乙干天梁化權
宮位四化：
．命宮庚干太陽化祿入夫妻宮
．命宮庚干武曲化權入子女宮
．命宮庚干太陰化科入財帛宮
．命宮庚干天同化忌入財帛宮
飛入四化：
．兄弟宮己干天梁化科入命宮
．夫妻宮戊干天機化忌入命宮
．子女宮己干天梁化科入命宮
．財帛宮戊干天機化忌入命宮
．疾厄宮丁干天機化科入命宮
．遷移宮丙干天機化權入命宮
．遷移宮丙干文昌化科入命宮
．僕役宮乙干天機化祿入命宮
．僕役宮乙干天梁化權入命宮
．福德宮壬干天梁化祿入命宮
．父母宮辛干文昌化忌入命宮
```

### 案例2：1975-10-23 男命 财帛宫（含自化）

```
【財帛宮：宮位在戊子】
大限年份：2018-2027
流年年份：1912,1924,1936,1948,1960,1972,1984,1996,2008,2020,2032,2044
主星有：天同旺．太陰廟
輔星有：左輔平．天魁平
生年四化：
．生年乙干太陰化忌
宮位四化：
．財帛宮戊干天機化忌入命宮
．財帛宮戊干右弼化科入夫妻宮
．財帛宮戊干貪狼化祿入子女宮
．財帛宮戊干太陰化權入財帛宮（自權）  ← 自化
飛入四化：
．命宮庚干太陰化科入財帛宮
．命宮庚干天同化忌入財帛宮
．夫妻宮戊干太陰化權入財帛宮
．疾厄宮丁干太陰化祿入財帛宮
．疾厄宮丁干天同化權入財帛宮
．遷移宮丙干天同化祿入財帛宮
．僕役宮乙干太陰化忌入財帛宮
．田宅宮癸干太陰化科入財帛宮
．福德宮壬干左輔化科入財帛宮
```

### 案例3：1984-09-19 女命 命宫（无生年四化）

```
【命宮：宮位在庚午】
大限年份：1988-1997
流年年份：1918,1930,1942,1954,1966,1978,1990,2002,2014,2026,2038,2050
主星有：無
輔星有：無
宮位四化：
．命宮庚干太陽化祿入財帛宮
．命宮庚干武曲化權入疾厄宮
．命宮庚干太陰化科入遷移宮
．命宮庚干天同化忌入遷移宮
```
（此例中没有生年四化飞入命宫，也没有其他宫位飞入）

## 格式规则总结

### 生年四化
- 格式：`生年 + 年干 + 干 + 星曜 + 化象`
- 示例：`生年乙干天機化祿`

### 宫位四化
- 格式：`发射宫 + 天干 + 干 + 星曜 + 化象 + 入 + 目的宫`
- 示例：`命宮庚干太陽化祿入夫妻宮`
- 自化：`財帛宮戊干太陰化權入財帛宮（自權）`

### 飞入四化
- 格式：`发射宫 + 天干 + 干 + 星曜 + 化象 + 入 + 目的宫`
- 示例：`兄弟宮己干天梁化科入命宮`

## 优点

1. **更简洁**：移除重复的"四化"字样
2. **更直观**：星曜和化象在中间，更容易看清楚哪颗星发生了什么化
3. **统一格式**：宫位四化和飞入四化使用相同的格式
4. **保留清晰度**：三个部分仍然分开显示，一目了然

## 技术实现

修改位置：`packages/core/src/index.ts`

关键改动：
```typescript
// 生年四化：移除"四化"二字
lines.push(`．生年${t.yearStem}干${t.star}${t.type}`);

// 宫位四化：调整格式，改用"入"
lines.push(`．${t.from}${fromStem}干${t.star}${t.type}入${t.to}${selfNote}`);

// 飞入四化：同宫位四化
lines.push(`．${t.from}${fromStem}干${t.star}${t.type}入${t.to}`);
```

## 测试验证

✅ 所有测试通过：
- 生年四化格式正确
- 宫位四化格式正确
- 飞入四化格式正确
- 自化标注正常
- 无四化情况处理正确
