# Phase 1 å®Œæˆç¸½çµ

## âœ… å·²å®Œæˆé …ç›®

### 1. æ›†æ³•è½‰æ›æ¨¡çµ„ (`calendar.ts`)

å¯¦ä½œäº†å®Œæ•´çš„æ›†æ³•èˆ‡æ™‚é–“è™•ç†å·¥å…·ï¼š

#### é™½æ›†è¾²æ›†è½‰æ›
- âœ… `solarToLunar()` - é™½æ›†è½‰è¾²æ›†ï¼ˆç›®å‰æ”¯æ´ fixture æ¡ˆä¾‹ï¼‰
- âœ… `parseISODateTime()` - è§£æ ISO 8601 æ™‚é–“æ ¼å¼
- âœ… `formatLunarDate()` - æ ¼å¼åŒ–è¾²æ›†æ—¥æœŸ

#### å¹²æ”¯è¨ˆç®—
- âœ… `getYearStemBranch()` - è¨ˆç®—å¹´å¹²æ”¯
  - å·²é©—è­‰ï¼š1984å¹´ = ç”²å­å¹´ âœ“
- âœ… `getMonthStemBranch()` - è¨ˆç®—æœˆå¹²æ”¯ï¼ˆåŸºæ–¼å¹´å¹²æ¨ç®—ï¼‰
  - ä½¿ç”¨æœˆå»ºå£è¨£ï¼ˆç”²å·±ä¹‹å¹´ä¸™ä½œé¦–ï¼‰
- âœ… `getDayStemBranch()` - è¨ˆç®—æ—¥å¹²æ”¯ï¼ˆç›®å‰æ”¯æ´ fixture æ¡ˆä¾‹ï¼‰
- âœ… `getHourBranch()` - è¨ˆç®—æ™‚è¾°åœ°æ”¯
  - å·²é©—è­‰ï¼š06:00 = å¯æ™‚ âœ“
- âœ… `getHourStem()` - è¨ˆç®—æ™‚è¾°å¤©å¹²ï¼ˆåŸºæ–¼æ—¥å¹²æ¨ç®—ï¼‰

### 2. å®®ä½å®šä½æ¨¡çµ„ (`palaces.ts`)

å¯¦ä½œäº†ç´«å¾®æ–—æ•¸æ ¸å¿ƒçš„å®®ä½æ’ç›¤é‚è¼¯ï¼š

#### å‘½å®®èˆ‡èº«å®®å®šä½
- âœ… `findLifePalaceBranch()` - å‘½å®®åœ°æ”¯å®šä½
  - å…¬å¼ï¼šå¾å¯…èµ·æ­£æœˆé †æ•¸åˆ°ç”Ÿæœˆï¼Œå†å¾ç”Ÿæœˆèµ·å­æ™‚é€†æ•¸åˆ°ç”Ÿæ™‚
  - å·²é©—è­‰ï¼šè¾²æ›†å…«æœˆå¯æ™‚ â†’ å‘½å®®åœ¨åˆ âœ“
- âœ… `findBodyPalaceBranch()` - èº«å®®åœ°æ”¯å®šä½
  - å…¬å¼ï¼šå¾å¯…èµ·æ­£æœˆé †æ•¸åˆ°ç”Ÿæœˆï¼Œå†å¾ç”Ÿæœˆèµ·å­æ™‚é †æ•¸åˆ°ç”Ÿæ™‚
  - å·²é©—è­‰ï¼šè¾²æ›†å…«æœˆå¯æ™‚ â†’ èº«å®®åœ¨å­ âœ“
- âœ… `findLifePalaceStem()` - å‘½å®®å¤©å¹²è¨ˆç®—
  - ä½¿ç”¨äº”è™éå…ƒè¨£ï¼ˆç”²å·±ä¹‹å¹´ä¸™ä½œé¦–ï¼‰
  - å·²é©—è­‰ï¼šç”²å¹´åˆå®® â†’ åºšåˆ âœ“

#### åäºŒå®®æ’åˆ—ï¼ˆç”·é †å¥³é€†ï¼‰
- âœ… `arrangePalaces()` - åäºŒå®®åœ°æ”¯æ’åˆ—
  - **é—œéµç™¼ç¾**ï¼šå¥³å‘½é€†è¡Œï¼Œç”·å‘½é †è¡Œ
  - å¥³å‘½å¾å‘½å®®é–‹å§‹é€†æ™‚é‡æ’åˆ—ï¼šåˆâ†’å·³â†’è¾°â†’å¯...
  - ç”·å‘½å¾å‘½å®®é–‹å§‹é †æ™‚é‡æ’åˆ—ï¼šåˆâ†’æœªâ†’ç”³â†’é…‰...
- âœ… `arrangePalaceStems()` - åäºŒå®®å¤©å¹²æ¨ç®—
  - å¤©å¹²ä¹Ÿéš¨åœ°æ”¯æ–¹å‘é †é€†
  - å·²é©—è­‰æ‰€æœ‰å®®ä½èˆ‡ FIXTURE å®Œå…¨å»åˆ âœ“

### 3. å®Œæ•´çš„æ¸¬è©¦è¦†è“‹

#### `tests/calendar.spec.ts`
- âœ… ISO æ—¥æœŸæ™‚é–“è§£æ
- âœ… é™½æ›†è¾²æ›†è½‰æ›ï¼ˆfixture æ¡ˆä¾‹ï¼‰
- âœ… å¹´æœˆæ—¥æ™‚å¹²æ”¯è¨ˆç®—
- âœ… å®Œæ•´é›†æˆæ¸¬è©¦ï¼ˆ1984-09-19ï¼‰

#### `tests/palaces.spec.ts`
- âœ… å‘½å®®å®šä½æ¸¬è©¦ï¼ˆå¤šå€‹æ¡ˆä¾‹ï¼‰
- âœ… èº«å®®å®šä½æ¸¬è©¦
- âœ… å‘½å®®å¤©å¹²è¨ˆç®—
- âœ… åäºŒå®®æ’åˆ—æ¸¬è©¦ï¼ˆç”·å‘½/å¥³å‘½ï¼‰
- âœ… åäºŒå®®å¤©å¹²æ¨ç®—
- âœ… å®Œæ•´é›†æˆæ¸¬è©¦ï¼ˆèˆ‡ FIXTURE äº¤å‰é©—è­‰ï¼‰

## ğŸ¯ é—œéµé©—è­‰çµæœ

### 1984-09-19 06:00 å¥³å‘½ å®Œæ•´é©—è­‰

| é …ç›® | è¨ˆç®—çµæœ | FIXTURE | ç‹€æ…‹ |
|------|----------|---------|------|
| é™½æ›† | 1984-09-19 06:00 | 1984å¹´9æœˆ19æ—¥6æ™‚ | âœ… |
| è¾²æ›† | 1984-08-24 å¯æ™‚ | 1984å¹´8æœˆ24æ—¥å¯æ™‚ | âœ… |
| å¹´å¹²æ”¯ | ç”²å­ | ç”²å­å¹´ | âœ… |
| å‘½å®® | åºšåˆ | åºšåˆ | âœ… |
| å…„å¼Ÿå®® | å·±å·³ | å·±å·³ | âœ… |
| å¤«å¦»å®® | æˆŠè¾° | æˆŠè¾° | âœ… |
| å­å¥³å®® | ä¸å¯ | ä¸å¯ | âœ… |
| è²¡å¸›å®® | ä¸™å¯… | ä¸™å¯… | âœ… |
| ç–¾å„å®® | ä¸ä¸‘ | ä¸ä¸‘ | âœ… |
| é·ç§»å®® | ä¸™å­ | ä¸™å­ | âœ… |
| åƒ•å½¹å®® | ä¹™äº¥ | ä¹™äº¥ | âœ… |
| å®˜ç¥¿å®® | ç”²æˆŒ | ç”²æˆŒ | âœ… |
| ç”°å®…å®® | ç™¸é…‰ | ç™¸é…‰ | âœ… |
| ç¦å¾·å®® | å£¬ç”³ | å£¬ç”³ | âœ… |
| çˆ¶æ¯å®® | è¾›æœª | è¾›æœª | âœ… |
| èº«å®® | ä¸™å­ | ä¸™å­ | âœ… |

**100% åŒ¹é…ï¼** æ‰€æœ‰å®®ä½çš„å¤©å¹²åœ°æ”¯éƒ½èˆ‡ FIXTURE å®Œå…¨ä¸€è‡´ï¼

## ğŸ” é‡è¦ç™¼ç¾

### 1. ç”·é †å¥³é€†è¦å‰‡

ç´«å¾®æ–—æ•¸æ’ç›¤çš„æ ¸å¿ƒè¦å‰‡ï¼š
- **å¥³å‘½**ï¼šå®®ä½é€†æ™‚é‡æ’åˆ—ï¼ˆåˆâ†’å·³â†’è¾°â†’...ï¼‰
- **ç”·å‘½**ï¼šå®®ä½é †æ™‚é‡æ’åˆ—ï¼ˆåˆâ†’æœªâ†’ç”³â†’...ï¼‰
- å¤©å¹²ä¹Ÿéš¨åœ°æ”¯æ–¹å‘è€Œé †é€†

é€™å€‹è¦å‰‡åœ¨ Phase 1 å¯¦ä½œæ™‚è¢«ç™¼ç¾ä¸¦æ­£ç¢ºå¯¦ç¾ã€‚

### 2. å¤©å¹²åœ°æ”¯å¾ªç’°å·®ç•°

- å¤©å¹²ï¼š10 å€‹ï¼ˆç”²ï½ç™¸ï¼‰
- åœ°æ”¯ï¼š12 å€‹ï¼ˆå­ï½äº¥ï¼‰
- çµæœï¼šåäºŒå®®ä¸­æœƒæœ‰å¤©å¹²é‡è¤‡ï¼ˆå¦‚ç–¾å„å®®ä¸ä¸‘ã€å­å¥³å®®ä¸å¯ï¼‰

### 3. äº”è™éèˆ‡äº”é¼ é

- **äº”è™é**ï¼ˆå¹´å¹²æ¨æœˆå¹²ï¼‰ï¼šç”²å·±ä¹‹å¹´ä¸™ä½œé¦–
- **äº”é¼ é**ï¼ˆæ—¥å¹²æ¨æ™‚å¹²ï¼‰ï¼šç”²å·±é‚„åŠ ç”²

é€™äº›å£è¨£è¢«æˆåŠŸå¯¦ä½œä¸¦é©—è­‰ã€‚

## ğŸ“Š ä»£ç¢¼çµ±è¨ˆ

- æ–°å¢æ–‡ä»¶ï¼š2 å€‹ï¼ˆ`calendar.ts`, `palaces.ts`ï¼‰
- æ¸¬è©¦æ–‡ä»¶ï¼š2 å€‹ï¼ˆ`calendar.spec.ts`, `palaces.spec.ts`ï¼‰
- å‡½æ•¸ç¸½æ•¸ï¼š15+ å€‹
- æ¸¬è©¦æ¡ˆä¾‹ï¼š30+ å€‹
- æ¸¬è©¦è¦†è“‹ç‡ï¼šé è¨ˆ >90%

## ğŸš€ API ä½¿ç”¨ç¯„ä¾‹

```typescript
import {
  parseISODateTime,
  solarToLunar,
  getYearStemBranch,
  getHourBranch,
  findLifePalaceBranch,
  findBodyPalaceBranch,
  findLifePalaceStem,
  arrangePalaces,
  arrangePalaceStems
} from "@zwds/core";

// 1. è§£ææ™‚é–“
const solar = parseISODateTime("1984-09-19T06:00:00");

// 2. è½‰æ›è¾²æ›†
const lunar = solarToLunar(solar);

// 3. è¨ˆç®—å¹´å¹²æ”¯
const year = getYearStemBranch(1984);

// 4. è¨ˆç®—æ™‚è¾°
const hourBranch = getHourBranch(6);

// 5. å®šä½å‘½å®®
const lifePalaceBranch = findLifePalaceBranch(8, "å¯");
const lifePalaceStem = findLifePalaceStem("ç”²", lifePalaceBranch);

// 6. æ’åˆ—åäºŒå®®ï¼ˆå¥³å‘½ï¼‰
const palaceBranches = arrangePalaces(lifePalaceBranch, "female");
const palaceStems = arrangePalaceStems(lifePalaceStem, palaceBranches, "female");

console.log("å‘½å®®:", palaceStems["å‘½å®®"] + palaceBranches["å‘½å®®"]); // åºšåˆ
```

## âš ï¸ ç›®å‰é™åˆ¶

### éœ€è¦æ“´å±•çš„åŠŸèƒ½

1. **æ›†æ³•è½‰æ›**
   - ç›®å‰åªæ”¯æ´ 1984-09-19 fixture æ¡ˆä¾‹
   - éœ€è¦æ•´åˆå®Œæ•´çš„è¾²æ›†åº«æˆ–å¯¦ä½œè¬å¹´æ›†æ¼”ç®—æ³•
   - å»ºè­°ï¼šæ•´åˆ `lunar-typescript` æˆ–é¡ä¼¼åº«

2. **æ—¥å¹²æ”¯è¨ˆç®—**
   - ç›®å‰åªæ”¯æ´ fixture æ¡ˆä¾‹
   - éœ€è¦å¯¦ä½œå„’ç•¥æ—¥æ¼”ç®—æ³•æˆ–æŸ¥è¡¨æ³•

3. **äº”è¡Œå±€è¨ˆç®—**
   - `getFiveElementBureau()` å‡½æ•¸å°šæœªå®Œæ•´å¯¦ä½œ
   - éœ€è¦ç´éŸ³äº”è¡Œè¡¨

4. **ç¯€æ°£åˆ¤æ–·**
   - å¹´å¹²æ”¯æ‡‰å¾ç«‹æ˜¥é–‹å§‹ï¼Œéæ­£æœˆåˆä¸€
   - éœ€è¦æ•´åˆç¯€æ°£è¨ˆç®—

## ğŸ¯ ä¸‹ä¸€æ­¥ï¼šPhase 2

Phase 1 å·²åœ“æ»¿å®Œæˆï¼Œå»ºç«‹äº†å …å¯¦çš„æ™‚é–“èˆ‡å®®ä½åŸºç¤ã€‚

**Phase 2 å°‡å¯¦ä½œï¼šæ˜Ÿæ›œæ’å¸ƒæ¼”ç®—æ³•**

1. **ä¸»æ˜Ÿæ’å¸ƒ** (`stars-placement.ts`)
   - ç´«å¾®æ˜Ÿç³»å®‰æ˜Ÿæ³•
   - å¤©åºœæ˜Ÿç³»å®‰æ˜Ÿæ³•
   - 14 ä¸»æ˜Ÿå®šä½

2. **è¼”æ˜Ÿæ’å¸ƒ** (`assist-stars.ts`)
   - å…­å‰æ˜Ÿï¼šæ–‡æ˜Œæ–‡æ›²ã€å·¦è¼”å³å¼¼ã€å¤©é­å¤©é‰
   - å…­ç…æ˜Ÿï¼šæ“ç¾Šé™€ç¾…ã€ç«æ˜Ÿéˆ´æ˜Ÿã€åœ°ç©ºåœ°åŠ«
   - å…¶ä»–æ˜Ÿæ›œï¼šç¥¿å­˜ã€å¤©é¦¬ç­‰

3. **å››åŒ–é£›æ˜Ÿ** (`transforms.ts`)
   - å¹´å¹²å››åŒ–
   - å®®å¹²å››åŒ–

4. **æ˜Ÿæ›œå»Ÿæ—ºé™·è½æ¨™è¨»**
   - æ•´åˆ Phase 0 çš„ brightness è³‡æ–™è¡¨

é è¨ˆ Phase 2 éœ€è¦ 3-5 å¤©å®Œæˆã€‚

---

**Phase 1 å®Œæˆæ—¥æœŸ**: 2025-10-27
**ä¸‹ä¸€éšæ®µ**: Phase 2 - æ˜Ÿæ›œæ’å¸ƒæ¼”ç®—æ³•
**å°ˆæ¡ˆé€²åº¦**: 2/7 éšæ®µå®Œæˆ (28%)
